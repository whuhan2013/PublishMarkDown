---
layout: post
title:  降维算法学习
date: 2016-12-13
categories: blog
tags: [机器学习]
description:  降维算法学习
---

#### 降维的动机     

首先,让我们谈论降维是什么。作为一种生动的例子,我们收集的数据集,有许多, 许多特征,我绘制两个在这里。       
![](https://raw.githubusercontent.com/whuhan2013/myImage/master/machineLearning/class9/p1.png)     

假设我们未知两个的特征 x1:长度:用厘米表示;X2,是用英寸表示同一物体的长度。
所以,这给了我们高度冗余表示,也许不是两个分开的特征 x1 和 X2,这两个基本的长 度度量,也许我们想要做的是减少数据到一维,只要有一个数就可以测量这个长度。     

有几个不同的的原 因使你可能想要做降维。一是数据压缩,后面我们会看了一些视频后,数据压缩不仅允许我 们压缩数据,因而使用较少的计算机内存或磁盘空间,但它也让我们加快我们的学习算法。     

![](https://raw.githubusercontent.com/whuhan2013/myImage/master/machineLearning/class9/p2.png) 

**动机二:数据可视化**      
在许多及其学习问题中,如果我们能将数据可视化,我们便能寻找到一个更好的解决方 案,降维可以帮助我们。     

假使我们有有关于许多不同国家的数据,每一个特征向量都有 50 个特征(如,GDP, 人均 GDP,平均寿命等)。如果要将这个 50 维的数据可视化是不可能的。使用降维的方法 将其降至 2 维,我们便可以将其可视化了。   

这样做的问题在于,降维的算法只负责减少维数,新产生的特征的意义就必须由我们自 己去发现了。   

#### 主成分分析问题(PCA)     

主成分分析(PCA)是最常见的降维算法。     
在 PCA 中,我们要做的是找到一个方向向量(Vector direction),当我们把所有的数据 都 投射到该向量上时,我们希望投射平均均方误差能尽可能地小。方向向量是一个经过原 点的向量,而投射误差是从特征向量向该方向向量作垂线的长度。  

![](https://raw.githubusercontent.com/whuhan2013/myImage/master/machineLearning/class9/p3.png) 

下面给出主成分分析问题的描述:
问题是要将 n 维数据降至 k 维,目标是找到向量 $u^{(1)},u^{(2)},...,u^{(k)}$使得总的投射误差最小。 

主成分分析与线性回顾的比较:  

主成分分析与线性回归是两种不同的算法。主成分分析最小化的是投射误差(Projected Error),而线性回归尝试的是最小化预测误差。线性回归的目的是预测结果,而主成分分析 不作任何预测。

PCA将n个特征降维到k个,可以用来进行数据压缩,如果100维的向量最后可以用10维来表示,那么压缩率为 90%。同样图像处理领域的 KL 变换使用 PCA 做图像压缩。但 PCA 要保证降维后,还要保证数据的特性损失最小。

PCA 技术的一大好处是对数据进行降维的处理。我们可以对新求出的“主元”向量的重 要性进行排序,根据需要取前面最重要的部分,将后面的维数省去,可以达到降维从而简化 模型或是对数据进行压缩的效果。同时最大程度的保持了原有数据的信息。

PCA 技术的一个很大的优点是,它是完全无参数限制的。在 PCA 的计算过程中完全不 需要人为的设定参数或是根据任何经验模型对计算进行干预,最后的结果只与数据相关,与 用户是独立的。
但是,这一点同时也可以看作是缺点。如果用户对观测对象有一定的先验知识,掌握了 数据的一些特征,却无法通过参数化等方法对处理过程进行干预,可能会得不到预期的效果, 效率也不高。   


**主成分分析算法**      
第一步是均值归一化。数据预处理。     
![](https://raw.githubusercontent.com/whuhan2013/myImage/master/machineLearning/class9/p4.png) 

我们需要计算出所有特征的均值,然后令 $x_j= x_j -μ_j$。如果特征是 在不同的数量级上,我们还需要将其除以标准差 $σ^2$。
![](https://raw.githubusercontent.com/whuhan2013/myImage/master/machineLearning/class9/p5.png) 

**选择主成分的数量**       

主要成分分析是减少投射的平均均方误差:     
训练集的方差为:$\frac{1}{m}\sum_{i=1}^{m}||x^{(i)}||^2$    

我们希望在平均均方误差与训练集方差的比例尽可能小的情况下选择尽可能小的 K 值。 

如果我们希望这个比例小于 1%,就意味着原本数据的偏差有 99%都保留下来了,如果
我们选择保留 95%的偏差,便能非常显著地降低模型中特征的维度了。

我们可以先令 K=1,然后进行主要成分分析,获得 $U_{reduce}$ 和 z,然后计算比例是否小于 1%。如果不是的话再令 K=2,如此类推,直到找到可以使得比例小于 1%的最小 K 值(原因
是各个特征之间通常情况存在某种相关性)。

还有一些更好的方式来选择 K,当我们在 Octave 中调用“svd”函数的时候,我们获得三
个参数:[U, S, V] = svd(sigma)。

![](https://raw.githubusercontent.com/whuhan2013/myImage/master/machineLearning/class9/p6.png)

**重建的压缩表示**     
在以前的视频中,我谈论 PCA 作为压缩算法。在那里你可能需要把 1000 维的数据压缩 100 维特征,或具有三维数据压缩到一二维表示。所以,如果这是一个压缩算法,应该能回 到这个压缩表示,回到你原有的高维数据的一种近似。

所以,给定的 $Z^{(i)}$,这可能 100 维,怎么回到你原来的表示 $x^{(i)}$,这可能是 1000 维的 数组?   

![](https://raw.githubusercontent.com/whuhan2013/myImage/master/machineLearning/class9/p7.png)

**主成分分析法的应用建议**    

假使我们正在针对一张 100×100 像素的图片进行某个计算机视觉的机器学习,即总共 有 10000 个特征。    
1. 第一步是运用主要成分分析将数据压缩至 1000 个特征      
2. 然后对训练集运行学习算法      
3. 在预测时,采用之前学习而来的 $U_{reduce}$ 将输入的特征 x 转换成特征向量 z,然后再 进行预测

注:如果我们有交叉验证集合测试集,也采用对训练集学习而来的 $U_{reduce}$。   

**错误的主要成分分析情况**:一个常见错误使用主要成分分析的情况是,将其用于减少过拟合 (减少了特征的数量)。这样做非常不好,不如尝试归一化处理。原因在于主要成分分析只 是近似地丢弃掉一些特征,它并不考虑任何与结果变量有关的信息,因此可能会丢失非常重 要的特征。然而当我们进行归一化处理时,会考虑到结果变量,不会丢掉重要的数据。

另一个常见的错误是,默认地将主要成分分析作为学习过程中的一部分,这虽然很多时 候有效果,最好还是从所有原始特征开始,只在有必要的时候(算法运行太慢或者占用太多 内存)才考虑采用主要成分分析。   

**pca的数学原理**    
[机器学习中的数学(5)-强大的矩阵奇异值分解(SVD)及其应用](http://www.cnblogs.com/LeftNotEasy/archive/2011/01/19/svd-and-applications.html)      
[PCA的数学原理](http://blog.codinglabs.org/articles/pca-tutorial.html)
